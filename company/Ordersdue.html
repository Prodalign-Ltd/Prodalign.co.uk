<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Orders Due</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root{
      --bg:#071826;
      --text:#fff;
      --muted:rgba(255,255,255,.75);
      --border:rgba(255,255,255,.10);
      --panel:rgba(255,255,255,.05);
      --panel2:rgba(255,255,255,.06);
      --shadow:0 18px 55px rgba(0,0,0,.45);

      /* highlight */
      --accent:#f57c00;
      --accentSoft:rgba(245,124,0,.20);
      --accentBorder:rgba(245,124,0,.55);
    }

    *{box-sizing:border-box}

    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      min-height:100vh;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% -10%, rgba(245,124,0,0.18), transparent 60%),
        linear-gradient(180deg, var(--bg) 0%, #06131e 100%);
      display:flex;
      flex-direction:column;
    }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:14px 18px;
      background: linear-gradient(90deg, rgba(16,44,68,.95), rgba(9,27,42,.92));
      border-bottom:1px solid var(--border);
    }

    .title{
      font-weight:900;
      font-size:18px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width:70vw;
    }

    button{
      border:1px solid rgba(255,255,255,0.12);
      border-radius:12px;
      padding:10px 14px;
      background:rgba(255,255,255,0.08);
      color:#fff;
      cursor:pointer;
      font-weight:800;
    }
    button:hover{ background:rgba(255,255,255,0.12); }

    .wrap{
      flex:1;
      display:flex;
      flex-direction:column;
      padding:18px;
      gap:12px;
      min-height:0; /* allow inner scroll areas */
    }

    .boardHeader{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:12px;
      padding:10px 6px 0;
    }
    .boardHeader h1{
      margin:0;
      font-size:22px;
      font-weight:900;
      letter-spacing:.2px;
    }
    .boardHeader p{
      margin:0;
      color:var(--muted);
      font-weight:700;
      font-size:13px;
    }

    /* Horizontal waterfall */
    .waterfall{
      flex:1;
      min-height:0;
      display:flex;
      gap:14px;
      padding:12px 6px 18px;
      overflow-x:auto;
      overflow-y:hidden;
      scroll-snap-type:x mandatory;
      -webkit-overflow-scrolling:touch;
    }

    /* nicer scrollbar */
    .waterfall::-webkit-scrollbar{ height:10px; }
    .waterfall::-webkit-scrollbar-thumb{
      background:rgba(255,255,255,0.15);
      border-radius:999px;
    }
    .waterfall::-webkit-scrollbar-track{
      background:rgba(255,255,255,0.06);
      border-radius:999px;
    }

    .stage{
      scroll-snap-align:start;
      width:320px;
      min-width:320px;
      max-width:320px;
      border-radius:18px;
      border:1px solid var(--border);
      background:var(--panel);
      box-shadow:var(--shadow);
      display:flex;
      flex-direction:column;
      min-height:0;
    }

    .stageHeader{
      padding:14px 14px 10px;
      border-bottom:1px solid rgba(255,255,255,0.08);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
    }

    .stageTitle{
      margin:0;
      font-size:14px;
      font-weight:950;
      letter-spacing:.2px;
      line-height:1.2;
    }

    .stageMeta{
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:6px;
      min-width:70px;
    }

    .badge{
      font-size:12px;
      font-weight:900;
      padding:5px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.06);
      color:rgba(255,255,255,.92);
      white-space:nowrap;
    }

    .hint{
      font-size:12px;
      color:var(--muted);
      font-weight:700;
      text-align:right;
      line-height:1.15;
    }

    .cards{
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:10px;
      overflow-y:auto;
      min-height:0;
    }

    .cards::-webkit-scrollbar{ width:10px; }
    .cards::-webkit-scrollbar-thumb{
      background:rgba(255,255,255,0.12);
      border-radius:999px;
    }
    .cards::-webkit-scrollbar-track{
      background:transparent;
    }

    .card{
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.10);
      background:linear-gradient(180deg, rgba(255,255,255,0.07), rgba(255,255,255,0.04));
      padding:12px;
      text-align:left;
    }

    .cardTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }

    .orderId{
      font-weight:950;
      font-size:14px;
      letter-spacing:.2px;
    }
    .due{
      font-size:12px;
      font-weight:900;
      color:rgba(255,255,255,.9);
      padding:4px 8px;
      border-radius:999px;
      background:rgba(255,255,255,0.06);
      border:1px solid rgba(255,255,255,0.10);
      white-space:nowrap;
    }

    .cardBody{
      display:grid;
      gap:6px;
      color:rgba(255,255,255,.92);
      font-weight:750;
      font-size:13px;
    }

    .row{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      color:rgba(255,255,255,.9);
    }

    .pill{
      font-size:12px;
      font-weight:900;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.10);
      background:rgba(255,255,255,0.05);
      color:rgba(255,255,255,.88);
    }

    .muted{ color:var(--muted); font-weight:750; }

    /* Highlight stage */
    .stage.highlight{
      border:1px solid var(--accentBorder);
      background:
        radial-gradient(700px 420px at 30% 0%, var(--accentSoft), transparent 55%),
        rgba(255,255,255,0.05);
      box-shadow:
        0 22px 70px rgba(0,0,0,.55),
        0 0 0 1px rgba(245,124,0,.15) inset;
      position:relative;
    }

    .stage.highlight .stageHeader{
      border-bottom:1px solid rgba(245,124,0,.25);
    }

    .stage.highlight .badge{
      border-color:rgba(245,124,0,.55);
      background:rgba(245,124,0,.15);
    }

    .stage.highlight::before{
      content:"";
      position:absolute;
      inset:10px;
      border-radius:14px;
      pointer-events:none;
      box-shadow:0 0 0 1px rgba(245,124,0,.22) inset;
    }

    /* Empty state */
    .empty{
      border:1px dashed rgba(255,255,255,0.18);
      background:rgba(255,255,255,0.04);
      border-radius:14px;
      padding:14px;
      color:var(--muted);
      font-weight:800;
      text-align:center;
    }

    @media (max-width:520px){
      .stage{ width:290px; min-width:290px; max-width:290px; }
      .boardHeader{ align-items:flex-start; flex-direction:column; }
    }
  </style>
</head>

<body>

<header>
  <div class="title" id="companyTitle">Orders Due</div>
  <button id="backBtn">Back to Overview</button>
</header>

<div class="wrap">
  <div class="boardHeader">
    <div>
      <h1>Orders Due</h1>
      <p>Scroll sideways → stages • scroll inside a stage → items</p>
    </div>
    <div class="muted" id="subtitle"></div>
  </div>

  <div class="waterfall" id="waterfall"></div>
</div>

<script>
  // Read ?c=company from URL
  const params = new URLSearchParams(window.location.search);
  const companyId = params.get("c");

  if (companyId) {
    document.getElementById("companyTitle").textContent = "Orders Due – " + companyId;
    document.getElementById("subtitle").textContent = "Company: " + companyId;
  } else {
    document.getElementById("subtitle").textContent = "Company: (not set)";
  }

  document.getElementById("backBtn").addEventListener("click", () => {
    window.location.href = companyId ? ("index.html?c=" + companyId) : "index.html";
  });

  /**
   * Dummy data (swap this array for Firestore results later)
   * Each item has a stage that determines which column it appears in.
   */
  const STAGES = [
    { key: "new",        title: "New Orders" },
    { key: "in_build",   title: "In Build" },
    { key: "qc",         title: "Quality Check" },
    { key: "ready_drop", title: "Order Ready Drop Zone", highlight: true },
    { key: "shipped",    title: "Shipped" }
  ];

  const dummyOrders = [
    { id: "ORD-10021", customer: "Acme Ltd",     due: "Today",       priority: "High",  items: 6,  stage: "new",        note: "Awaiting parts confirmation" },
    { id: "ORD-10022", customer: "Blue Finch",   due: "Tomorrow",    priority: "Med",   items: 2,  stage: "in_build",   note: "Build in progress" },
    { id: "ORD-10023", customer: "Kite & Co",    due: "Fri",         priority: "Low",   items: 10, stage: "qc",         note: "Final inspection pending" },
    { id: "ORD-10024", customer: "Northwind",    due: "Fri",         priority: "High",  items: 4,  stage: "ready_drop", note: "Ready for pickup / dispatch" },
    { id: "ORD-10025", customer: "Pineapple BV", due: "Next week",   priority: "Med",   items: 1,  stage: "ready_drop", note: "Label printed" },
    { id: "ORD-10026", customer: "Sunset Inc",   due: "Next week",   priority: "Low",   items: 3,  stage: "shipped",    note: "Tracking sent" },
    { id: "ORD-10027", customer: "Acme Ltd",     due: "Mon",         priority: "High",  items: 8,  stage: "in_build",   note: "Waiting on QA slot" }
  ];

  function el(tag, attrs = {}, children = []) {
    const node = document.createElement(tag);
    for (const [k, v] of Object.entries(attrs)) {
      if (k === "class") node.className = v;
      else if (k === "text") node.textContent = v;
      else node.setAttribute(k, v);
    }
    for (const child of children) node.appendChild(child);
    return node;
  }

  function renderBoard(items) {
    const root = document.getElementById("waterfall");
    root.innerHTML = "";

    for (const stage of STAGES) {
      const stageItems = items.filter(o => o.stage === stage.key);

      const stageCol = el("section", {
        class: "stage" + (stage.highlight ? " highlight" : ""),
        "data-stage": stage.key
      });

      const header = el("div", { class: "stageHeader" }, [
        el("div", {}, [
          el("h2", { class: "stageTitle", text: stage.title })
        ]),
        el("div", { class: "stageMeta" }, [
          el("div", { class: "badge", text: stageItems.length + " item" + (stageItems.length === 1 ? "" : "s") }),
          el("div", { class: "hint", text: stage.highlight ? "Highlighted stage" : " " })
        ])
      ]);

      const cardsWrap = el("div", { class: "cards" });

      if (stageItems.length === 0) {
        cardsWrap.appendChild(
          el("div", { class: "empty", text: "No orders in this stage." })
        );
      } else {
        for (const o of stageItems) {
          const card = el("div", { class: "card" }, [
            el("div", { class: "cardTop" }, [
              el("div", { class: "orderId", text: o.id }),
              el("div", { class: "due", text: "Due: " + o.due })
            ]),
            el("div", { class: "cardBody" }, [
              el("div", { class: "row" }, [
                el("span", { class: "muted", text: o.customer })
              ]),
              el("div", { class: "row" }, [
                el("span", { class: "pill", text: "Priority: " + o.priority }),
                el("span", { class: "pill", text: "Items: " + o.items })
              ]),
              el("div", { class: "row" }, [
                el("span", { class: "muted", text: o.note })
              ])
            ])
          ]);

          // later: click -> open order details
          card.addEventListener("click", () => {
            console.log("Clicked", o.id);
          });

          cardsWrap.appendChild(card);
        }
      }

      stageCol.appendChild(header);
      stageCol.appendChild(cardsWrap);
      root.appendChild(stageCol);
    }
  }

  // Initial render with dummy data
  renderBoard(dummyOrders);

  /**
   * Later (Firestore):
   * - Fetch docs, map into the same shape as dummyOrders
   * - Call renderBoard(firestoreOrders)
   */
</script>

</body>
</html>
